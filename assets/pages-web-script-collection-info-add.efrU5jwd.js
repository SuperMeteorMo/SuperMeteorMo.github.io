import{e,X as a,G as t,D as o,A as s,v as l,m as r,c as i,w as n,i as m,o as u,a as d,b as c,$ as f}from"./index-86rZ-D-t.js";import{_ as p}from"./uni-easyinput.CTOjbJ8w.js";import{r as h}from"./uni-app.es.Cksdd9Qe.js";import{_}from"./uni-forms-item.CyYqCa5A.js";import{_ as b}from"./uni-forms.B_CTfGEe.js";import{v as w}from"./web-script-collection-info.Cjjrus_3.js";import{s as y}from"./store.1mgwHa0O.js";import{_ as D}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.jo3z_KBL.js";const j=e.database();function V(e){let a={};for(let t in w)e.indexOf(t)>-1&&(a[t]=w[t]);return a}const v=D({data(){let e={name:"",description:"",show:null};return{formData:e,formOptions:{},rules:{...V(Object.keys(e))}}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){a({mask:!0}),this.$refs.form.validate().then((e=>this.submitForm(e))).catch((()=>{})).finally((()=>{t()}))},async submitForm(e){try{var a=await j.collection("web-script-collection-info").add(e);await j.collection("web-like-collection").add({collect_id:a.result.id,sort:0,collect_user_id:y.userInfo._id});o({icon:"none",title:"新增成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>s()),500)}catch(t){l({content:err.message||"请求服务失败",showCancel:!1})}}}},[["render",function(e,a,t,o,s,l){const w=h(r("uni-easyinput"),p),y=h(r("uni-forms-item"),_),D=f,j=m,V=h(r("uni-forms"),b);return u(),i(j,{class:"uni-container"},{default:n((()=>[d(V,{ref:"form",model:s.formData,"validate-trigger":"submit","err-show-type":"toast"},{default:n((()=>[d(y,{name:"name",label:""},{default:n((()=>[d(w,{placeholder:"合集标题",modelValue:s.formData.name,"onUpdate:modelValue":a[0]||(a[0]=e=>s.formData.name=e)},null,8,["modelValue"])])),_:1}),d(y,{name:"description",label:""},{default:n((()=>[d(w,{placeholder:"合集描述",modelValue:s.formData.description,"onUpdate:modelValue":a[1]||(a[1]=e=>s.formData.description=e)},null,8,["modelValue"])])),_:1}),d(y,{name:"show",label:""},{default:n((()=>[d(w,{placeholder:"合集展示",type:"number",modelValue:s.formData.show,"onUpdate:modelValue":a[2]||(a[2]=e=>s.formData.show=e)},null,8,["modelValue"])])),_:1}),d(j,{class:"uni-button-group"},{default:n((()=>[d(D,{type:"primary",class:"uni-button",onClick:l.submit},{default:n((()=>[c("提交")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model"])])),_:1})}],["__scopeId","data-v-9f94edc7"]]);export{v as default};
