import{f as e,g as o,h as r,j as s,n as a,s as t,k as n,c as l,w as i,i as c,o as d,a as h,d as u,r as p,F as m,S as f}from"./index-CpH68wGS.js";import{_ as w}from"./uni-icons.n7LShZtt.js";import{r as g}from"./uni-app.es.sM20WYHF.js";import{_}from"./uni-search-bar.CHokwmRT.js";import{_ as b}from"./bannerScript.K8u7D0-C.js";import{_ as y}from"./uni-load-state.lm77UAPP.js";import{_ as k}from"./unicloud-db.C6zbua0L.js";import{s as j}from"./uni-status-bar._Y8GoReW.js";import{_ as C}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-dateformat.Dwr3vbvB.js";let R;const M=e.database();const F=C({components:{statusBar:j},computed:{inputPlaceholder:e=>"en"==o("CURRENT_LANG")?"Please enter the search content":"请输入搜索内容",colList(){return[M.collection("web-script").where(this.where).field('id,name,description,"update-id",host,publisher,publish_date,day,total,user_id,create_date,version,show').getTemp(),M.collection("uni-id-users").field("_id,nickname").getTemp()]}},data:()=>({where:'"show" > 1',keyword:"",showRefresh:!1,listHight:0}),watch:{keyword(e,o){let r='"show" > 1';this.where=e?r+`&& /${e}/.test(name)`:r,console.log("搜索",this.where)}},async onReady(){this.listHight="auto",R=this.$refs.udb},async onShow(){this.keyword=r().globalData.searchText,console.log("显示",this.keyword)},methods:{searchClick(e){s(),a({url:"/pages/list/search/search",animationType:"fade-in"})},retry(){this.refresh()},refresh(){R.loadData({clear:!0},(()=>{t(),console.log("end")})),console.log("refresh")},loadMore(){R.loadMore()},onqueryerror(e){console.error(e)},onpullingdown(e){console.log(e),this.showRefresh=!0,e.pullingDistance>100&&this.refresh()}},onPullDownRefresh(){this.refresh()},onReachBottom(){this.loadMore()}},[["render",function(e,o,r,s,a,t){const j=g(n("uni-icons"),w),C=g(n("uni-search-bar"),_),R=c,M=g(n("bannerScript"),b),F=g(n("uni-load-state"),y),x=f,D=g(n("unicloud-db"),k);return d(),l(R,{class:"page-container"},{default:i((()=>[h(R,{class:"search-container"},{default:i((()=>[h(C,{modelValue:a.keyword,"onUpdate:modelValue":o[0]||(o[0]=e=>a.keyword=e),radius:"30",bgColor:"#FFFFFF",placeholderColor:"#A0AEC0",cancelButton:"none",placeholder:t.inputPlaceholder,onConfirm:e.searchConfirm},{searchIcon:i((()=>[h(j,{type:"search",size:"18",color:"#718096"})])),_:1},8,["modelValue","placeholder","onConfirm"])])),_:1}),h(D,{ref:"udb",orderby:"show desc",where:a.where,onError:t.onqueryerror,collection:"web-script","page-size":10},{default:i((({data:e,pagination:o,hasMore:r,loading:s,error:a,options:n})=>[h(x,{class:"content-scroll","scroll-y":"","show-scrollbar":!1,enhanced:!0,bounces:!1},{default:i((()=>[h(R,{class:"list-container"},{default:i((()=>[(d(!0),u(m,null,p(e,((e,o)=>(d(),l(M,{key:o,item:e},null,8,["item"])))),128))])),_:2},1024),h(R,{class:"loading-state"},{default:i((()=>[h(F,{onNetworkResume:t.refresh,state:{data:e,pagination:o,hasMore:r,loading:s,error:a},onLoadMore:t.loadMore},null,8,["onNetworkResume","state","onLoadMore"])])),_:2},1024)])),_:2},1024)])),_:1},8,["where","onError"])])),_:1})}],["__scopeId","data-v-318a566b"]]);export{F as default};
